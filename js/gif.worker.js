!function(t){function e(r){if(i[r])return i[r].exports;var s=i[r]={exports:{},id:r,loaded:!1};return t[r].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(2)},function(t,e){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),s=function(){function t(){i(this,t),this.buf=[],this.pos=0}return r(t,[{key:"getData",value:function(){return this.buf}},{key:"writeByte",value:function(t){this.buf[this.pos++]=t&255}},{key:"writeUTFBytes",value:function(t){for(var e=t.length,i=0;e>i;i++)this.writeByte(t.charCodeAt(i))}},{key:"writeBytes",value:function(t,e,i){for(var r=0;i>r;r++)this.writeByte(t[e+r])}}]),t}();t.exports=s},function(t,e,i){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),o=i(3),h=r(o),a=i(1),f=r(a),l=function(){function t(e){s(this,t),this.running=!1,this.options={},this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.setOptions(e),this.initialize()}return n(t,[{key:"setOptions",value:function(t){this.running=!1,this.options={},this.freeWorkers.length=0,this.activeWorkers.length=0,this.setOption("workers",2),this.setOption("repeat",0),this.setOption("quality",10),this.setOption("width",null),this.setOption("height",null),this.setOption("transparent",null),this.setOption("background","#fff"),this.setOption("image",null),this.setOption("watermark",null);for(var e in t)t.hasOwnProperty(e)&&this.setOption(e,t[e])}},{key:"setOption",value:function(t,e){this.options[t]=e}},{key:"initialize",value:function(){var t=this;this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.sizeSet=!1,this.repeat=parseInt(this.options.repeat),this.frames=[],this.freeWorkers=[],this.activeWorkers=[],this.frameCount=0;var e=this.options.workers;if(e>0)for(var i=0;e>i;i++)this.spawnWorker()}},{key:"spawnWorker",value:function(){var t=this,e=new Worker(this.options.workerScript);e.onmessage=function(i){t.activeWorkers.splice(t.activeWorkers.indexOf(e),1),t.freeWorkers.push(e),t.frameFinished(i.data)},this.freeWorkers.push(e)}},{key:"frameFinished",value:function(t){if(this.frames[t.index]=t.frame,this.imageParts--,0===this.imageParts){this.finishRendering();var e=new f.default;e.writeUTFBytes("GIF89a");var i=parseInt(this.options.width),r=parseInt(this.options.height);e.writeBytes(new Uint8Array([i&255,i>>8&255,r&255,r>>8&255,this.repeat>=0?33:0,0,0]));var s=this.frames[0].data;e.writeBytes(s);for(var n=1;n<this.frames.length;n++){var o=this.frames[n].data;e.writeBytes(o)}e.writeBytes(new Uint8Array([59])),this.onRenderCompleteCallback(new Blob([e.getData()],{type:"image/gif"}))}}},{key:"addFrame",value:function(t,e){var i=this;if(e=e||{},/^(data:|blob:)/.test(t.src)){var r=document.createElement("img");r.src=t.src,t=r}if(!(t.width&&t.height))throw new Error("Please provide actual width and height for the image");this.sizeSet||(this.setOption("width",t.width),this.setOption("height",t.height),this.sizeSet=!0),this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.ctx.drawImage(t,0,0,this.options.width,this.options.height);var s=this.ctx.getImageData(0,0,this.options.width,this.options.height);this.frames.push({data:s,delay:e.delay||this.options.delay||100}),this.frameCount++}},{key:"render",value:function(){var t=this;if(!this.running){this.running=!0,this.imageParts=this.frames.length,this.spawnWorkers();var e=0,i=function r(){var i=t.freeWorkers.shift();if(i){var s=t.frames[e];i.postMessage({frame:s,index:e,quality:t.options.quality,delay:s.delay,repeat:t.repeat,transparent:t.options.transparent,background:t.options.background,dither:t.options.dither}),t.activeWorkers.push(i),e++,e<t.frames.length&&r()}};i()}}},{key:"abort",value:function(){for(var t=0;t<this.activeWorkers.length;t++)this.activeWorkers[t].terminate();this.running=!1}},{key:"on",value:function(t,e){return"finished"===t&&(this.onRenderCompleteCallback=e),this}}]),t}();t.exports=l},function(t,e){"use strict";t.exports=function(t){var e=t.length;if(e<65537&&t[0]===t[e-1])return!0;for(var i=0;e-1>i;i++)if(t[i]===t[i+1])return!0;return!1}}]);